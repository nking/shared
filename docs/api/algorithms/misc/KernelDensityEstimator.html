<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) on Fri Oct 04 17:26:50 PDT 2024 -->
<title>KernelDensityEstimator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2024-10-04">
<meta name="description" content="declaration: package: algorithms.misc, class: KernelDensityEstimator">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
<script type="text/javascript" src="../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">algorithms.misc</a></div>
<h1 title="Class KernelDensityEstimator" class="title">Class KernelDensityEstimator</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">algorithms.misc.KernelDensityEstimator</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">KernelDensityEstimator</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">TODO: consider implementing the Improved Sheather - Jones algorithm for estimating bandwidth:.
 can see implementations
 https://github.com/tommyod/KDEpy/blob/master/KDEpy/bw_selection.py
 and
 https://kdepy.readthedocs.io/en/latest/_modules/KDEpy/FFTKDE.html#FFTKDE

 TODO: consider implementing
 "Fast and Accurate Gaussian Kernel Density Estimation", Jeffrey Heer, University of Washiington.
 https://idl.cs.washington.edu/files/2021-FastKDE-VIS.pdf

 TODO: consider using MSER in a 2-D KDE estimator

 TODO: explore https://github.com/TasCL/cpda/ one day.
 Probability Density Approximation.
 The authors are Yi-Shin Lin yishin.lin@utas.edu.au, Andrew Heathcote, William Holmes
 The repository implements some of
 Holmes, W. (2015). A practical guide to the Probability Density Approximation (PDA) with improved implementation
 and error characterization. Journal of Mathematical Psychology, 68-69, 13--24, doi:
 http://dx.doi.org/10.1016/j.jmp.2015.08.006.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static class&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="KernelDensityEstimator.KDE.html" class="type-name-link" title="class in algorithms.misc">KernelDensityEstimator.KDE</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>(package private) static final double</code></div>
<div class="col-second even-row-color"><code><a href="#BIG" class="member-name-link">BIG</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">KernelDensityEstimator</a>()</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>protected static boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#assertHistRange(double%5B%5D,double%5B%5D,double)" class="member-name-link">assertHistRange</a><wbr>(double[]&nbsp;histBins,
 double[]&nbsp;dataMinMax,
 double&nbsp;h)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>protected static <a href="Complex.html" title="class in algorithms.misc">Complex</a>[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#convertToComplex(double%5B%5D)" class="member-name-link">convertToComplex</a><wbr>(double[]&nbsp;a)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double[][]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#createFineHistogram(double%5B%5D,double)" class="member-name-link">createFineHistogram</a><wbr>(double[]&nbsp;x,
 double&nbsp;h)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">calculate a fine resolution histogram for x, for a larger data range than x's.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>protected static double[][]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#createFineHistogram(double%5B%5D,double,int,double,double,double)" class="member-name-link">createFineHistogram</a><wbr>(double[]&nbsp;x,
 double&nbsp;h,
 int&nbsp;nBins,
 double&nbsp;binWidth,
 double&nbsp;minBin,
 double&nbsp;maxBin)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">calculate a fine resolution histogram for x, for a larger data range than x's.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>protected static double[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#createFineHistogramSubstitute(double%5B%5D)" class="member-name-link">createFineHistogramSubstitute</a><wbr>(double[]&nbsp;x)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">calculate a substitute for the fine resolution histogram for x for use in the
 risk estimator that uses cross-validation.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#crossValidationScore(algorithms.misc.Complex%5B%5D,double%5B%5D,double)" class="member-name-link">crossValidationScore</a><wbr>(<a href="Complex.html" title="class in algorithms.misc">Complex</a>[]&nbsp;u,
 double[]&nbsp;histBins,
 double&nbsp;h)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">a fast cross-validation method which can be used in choosing the bandwidth for the kernel density estimator.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#optimalBandwidthGaussianKernel(double,int)" class="member-name-link">optimalBandwidthGaussianKernel</a><wbr>(double&nbsp;standardDeviation,
 int&nbsp;nSample)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">assuming a zero-centered mean gaussian kernel, return the bandwidth which minimizes the
 mean integrated squared error (MISE).</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>(package private) static double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#riskEstimatorDataSplitting()" class="member-name-link">riskEstimatorDataSplitting</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">calculate the risk estimator for the "data-splitting" V-fold or k-fold method of cross validation.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>(package private) static double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#riskEstimatorGaussianKernel()" class="member-name-link">riskEstimatorGaussianKernel</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">calculate the risk estimator for the "leave-one-out" method of cross validation.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>(package private) static double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#riskEstimatorLeaveOneOut()" class="member-name-link">riskEstimatorLeaveOneOut</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">calculate the risk estimator for the "leave-one-out" method of cross validation.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#ruleOfThumbBandwidthGaussianKernel(double,double,int)" class="member-name-link">ruleOfThumbBandwidthGaussianKernel</a><wbr>(double&nbsp;standardDeviation,
 double&nbsp;IQR,
 int&nbsp;nSample)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">assuming a zero-centered mean gaussian kernel, return Silverman's "rule of thumb" bandwidth.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>(package private) static double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#sumHistogram(double%5B%5D%5B%5D)" class="member-name-link">sumHistogram</a><wbr>(double[][]&nbsp;hist)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>(package private) static double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#sumKDE(double%5B%5D,double)" class="member-name-link">sumKDE</a><wbr>(double[]&nbsp;kde,
 double&nbsp;dk)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#univariateKernelDensityEstimate(algorithms.misc.IKernel,double,double%5B%5D,double)" class="member-name-link">univariateKernelDensityEstimate</a><wbr>(<a href="IKernel.html" title="interface in algorithms.misc">IKernel</a>&nbsp;kernel,
 double&nbsp;x,
 double[]&nbsp;xTilde,
 double&nbsp;h)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">estimate the KDE for a single value x.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="KernelDensityEstimator.KDE.html" title="class in algorithms.misc">KernelDensityEstimator.KDE</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#viaFFTGaussKernel(double%5B%5D,double)" class="member-name-link">viaFFTGaussKernel</a><wbr>(double[]&nbsp;x,
 double&nbsp;h)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">estimate the density by using properties of exponentials 
     (convolution, discrete FFT, fourier pairs ...) to make a faster algorithm.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="KernelDensityEstimator.KDE.html" title="class in algorithms.misc">KernelDensityEstimator.KDE</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#viaFFTGaussKernel(double%5B%5D,double,int,double,double,double)" class="member-name-link">viaFFTGaussKernel</a><wbr>(double[]&nbsp;x,
 double&nbsp;h,
 int&nbsp;histNBins,
 double&nbsp;histBinWidth,
 double&nbsp;histMinBin,
 double&nbsp;histMaxBin)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">estimate the density by using properties of exponentials (convolution, discrete FFT, fourier pairs ...) 
     to make a faster algorithm.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="KernelDensityEstimator.KDE.html" title="class in algorithms.misc">KernelDensityEstimator.KDE</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#viaFFTGaussKernel(algorithms.misc.Complex%5B%5D,double%5B%5D,double)" class="member-name-link">viaFFTGaussKernel</a><wbr>(<a href="Complex.html" title="class in algorithms.misc">Complex</a>[]&nbsp;u,
 double[]&nbsp;histBins,
 double&nbsp;h)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">estimate the density by using properties of exponentials 
     (convolution, discrete FFT, fourier pairs ...) to make a faster algorithm.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="KernelDensityEstimator.KDE.html" title="class in algorithms.misc">KernelDensityEstimator.KDE</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#viaGaussKernel(double%5B%5D,double)" class="member-name-link">viaGaussKernel</a><wbr>(double[]&nbsp;x,
 double&nbsp;h)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">estimate the density of x using a Gaussian Kernel of bandwidth h.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="KernelDensityEstimator.KDE.html" title="class in algorithms.misc">KernelDensityEstimator.KDE</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#viaGaussKernel(double%5B%5D,double%5B%5D,double)" class="member-name-link">viaGaussKernel</a><wbr>(double[]&nbsp;x,
 double[]&nbsp;xGrid,
 double&nbsp;h)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">estimate the density of x using a Gaussian Kernel of bandwidth h.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="BIG">
<h3>BIG</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">BIG</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../constant-values.html#algorithms.misc.KernelDensityEstimator.BIG">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>KernelDensityEstimator</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">KernelDensityEstimator</span>()</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="optimalBandwidthGaussianKernel(double,int)">
<h3>optimalBandwidthGaussianKernel</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">optimalBandwidthGaussianKernel</span><wbr><span class="parameters">(double&nbsp;standardDeviation,
 int&nbsp;nSample)</span></div>
<div class="block">assuming a zero-centered mean gaussian kernel, return the bandwidth which minimizes the
 mean integrated squared error (MISE).
 NOTE, the method ruleOfThumbBandwidthGaussianKernel() is preferred.
 <pre>
     Silverman 1981, "Kernel Density Estimation Using theFast Fourier Transform"
 </pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>standardDeviation</code> - </dd>
<dd><code>nSample</code> - </dd>
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="ruleOfThumbBandwidthGaussianKernel(double,double,int)">
<h3>ruleOfThumbBandwidthGaussianKernel</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">ruleOfThumbBandwidthGaussianKernel</span><wbr><span class="parameters">(double&nbsp;standardDeviation,
 double&nbsp;IQR,
 int&nbsp;nSample)</span></div>
<div class="block">assuming a zero-centered mean gaussian kernel, return Silverman's "rule of thumb" bandwidth.
 This is considered an improvement over the optimal bandwidth for gaussian kernels.
 <pre>
     Silverman's ‘rule of thumb’, Silverman (1986, page 48, eqn (3.31))).
     and
     https://rdrr.io/r/stats/bandwidth.html
     </pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>standardDeviation</code> - </dd>
<dd><code>nSample</code> - </dd>
<dd><code>IQR</code> - the interquartile range which is the ordered statistic divided into 4 equal parts, each summed,
            then iqr = the 3rd quartile minus the first quartile = sum[3] - sum[0].
            see MiscMath0.calcMedianAndIQR()</dd>
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="viaFFTGaussKernel(double[],double,int,double,double,double)">
<h3>viaFFTGaussKernel</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="KernelDensityEstimator.KDE.html" title="class in algorithms.misc">KernelDensityEstimator.KDE</a></span>&nbsp;<span class="element-name">viaFFTGaussKernel</span><wbr><span class="parameters">(double[]&nbsp;x,
 double&nbsp;h,
 int&nbsp;histNBins,
 double&nbsp;histBinWidth,
 double&nbsp;histMinBin,
 double&nbsp;histMaxBin)</span></div>
<div class="block">estimate the density by using properties of exponentials (convolution, discrete FFT, fourier pairs ...) 
     to make a faster algorithm.
     <pre>
     reference:
     Silverman, B. W. (1982). Algorithm as 176: Kernel density estimation using the fast Fourier transform. Journal of the Royal Statistical Society. Series C (Applied Statistics), 31(1), 93-99. https://dx.doi.org/10.2307/2347084.
     https://www.jstor.org/stable/2347084#metadata_info_tab_contents
     </pre>
     calculate the KDE in a fast manner by using discrete FFTs and using a grid of data points
     the kde = f_hat(x) ~ summation over i=1 to n of (K(|| x - X_i ||/h).
     the kernel estimate is a convolution of the data with the kernel.
     naive implementation is O(n^2).
     if the kernel K is chosen to be a Gaussian, one can use a property of exponentials 
     (convolution, discrete FFT, fourier pairs ...) to rewrite:
     exp(x - X_i) = exp(x) * exp(-X_i) (neglecting details)
     also note that the discrete FFT is a summation of exponentials.
     convolution theorem: one can use the pointwise multiplication between the fourier paired functions.
     (Chap 15.5, Boas "Mathematical Methods in the Physical Sciences")
     convolution to FFT:
     FFT(kde) ~ FFT(K(h*s)) * FFT( hist(X) )
     one can choose s to be the same spatial intervals (=grid) in the histogram
     and in the kernel, to avoid interpolation.  the multiplication is pointwise.
     then inverse FFT of FFT(kde) = kde.
     the runtime complexity is then O(n_s*log(n_s))</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>x</code> - observed data</dd>
<dd><code>h</code> - bandwidth</dd>
<dd><code>histNBins</code> - </dd>
<dd><code>histMaxBin</code> - </dd>
<dd><code>histMinBin</code> - </dd>
<dd><code>histBinWidth</code> - </dd>
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="viaFFTGaussKernel(double[],double)">
<h3>viaFFTGaussKernel</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="KernelDensityEstimator.KDE.html" title="class in algorithms.misc">KernelDensityEstimator.KDE</a></span>&nbsp;<span class="element-name">viaFFTGaussKernel</span><wbr><span class="parameters">(double[]&nbsp;x,
 double&nbsp;h)</span></div>
<div class="block">estimate the density by using properties of exponentials 
     (convolution, discrete FFT, fourier pairs ...) to make a faster algorithm.
     <pre>
     reference:
     Silverman, B. W. (1982). Algorithm as 176: Kernel density estimation using the fast Fourier transform. Journal of the Royal Statistical Society. Series C (Applied Statistics), 31(1), 93-99. https://dx.doi.org/10.2307/2347084.
     https://www.jstor.org/stable/2347084#metadata_info_tab_contents
     </pre>
     calculate the KDE in a fast manner by using discrete FFTs and using a grid of data points
     the kde = f_hat(x) ~ summation over i=1 to n of (K(|| x - X_i ||/h).
     the kernel estimate is a convolution of the data with the kernel.
     naive implementation is O(n^2).
     if the kernel K is chosen to be a Gaussian, one can use a property of exponentials to rewrite:
     exp(x - X_i) = exp(x) * exp(-X_i) (neglecting details)
     also note that the discrete FFT is a summation of exponentials.
     convolution theorem: one can use the pointwise multiplication between the fourier paired functions.
     (Chap 15.5, Boas "Mathematical Methods in the Physical Sciences")
     convolution to FFT:
     FFT(kde) ~ FFT(K(h*s)) * FFT( hist(X) )
     one can choose s to be the same spatial intervals (=grid) in the histogram
     and in the kernel, to avoid interpolation.  the multiplication is pointwise.
     then inverse FFT of FFT(kde) = kde.
     the runtime complexity is then O(n_s*log(n_s))</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>x</code> - data observed</dd>
<dd><code>h</code> - bandwidth</dd>
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="viaGaussKernel(double[],double)">
<h3>viaGaussKernel</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="KernelDensityEstimator.KDE.html" title="class in algorithms.misc">KernelDensityEstimator.KDE</a></span>&nbsp;<span class="element-name">viaGaussKernel</span><wbr><span class="parameters">(double[]&nbsp;x,
 double&nbsp;h)</span></div>
<div class="block">estimate the density of x using a Gaussian Kernel of bandwidth h.
 note that the grid to which the kernel is applied is also x in this case.
     <pre>
     f_hat(x) ~ (1/n) * summation over i=1 to n of ( (1/h) * K(|| x - X_i ||/h) ).
     double[] kde = iter from j=1-1 to xGrid.length-1 estimating f_hat(xGrid[j]
     reference: Wasserman's "All of Statistics", eqn (20.21)
     </pre>
     runtime complexity is O(n^2) where n = x.length.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>x</code> - data observed</dd>
<dd><code>h</code> - bandwidth</dd>
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="viaGaussKernel(double[],double[],double)">
<h3>viaGaussKernel</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="KernelDensityEstimator.KDE.html" title="class in algorithms.misc">KernelDensityEstimator.KDE</a></span>&nbsp;<span class="element-name">viaGaussKernel</span><wbr><span class="parameters">(double[]&nbsp;x,
 double[]&nbsp;xGrid,
 double&nbsp;h)</span></div>
<div class="block">estimate the density of x using a Gaussian Kernel of bandwidth h.
 the grid to which the kernel is applied is xGrid in this case.
     <pre>
     f_hat(x) ~ (1/n) * summation over i=1 to n of ( (1/h) * K(|| x - X_i ||/h) ).
     double[] kde = iter from j=1-1 to xGrid.length-1 estimating f_hat(xGrid[j]
     reference: Wasserman's "All of Statistics", eqn (20.21)
     </pre>
     runtime complexity is O(n*m) where n = x.length and m=xGrid.length</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>x</code> - data observed</dd>
<dd><code>xGrid</code> - the grid of data at which to apply the kernel.</dd>
<dd><code>h</code> - bandwidth</dd>
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="convertToComplex(double[])">
<h3>convertToComplex</h3>
<div class="member-signature"><span class="modifiers">protected static</span>&nbsp;<span class="return-type"><a href="Complex.html" title="class in algorithms.misc">Complex</a>[]</span>&nbsp;<span class="element-name">convertToComplex</span><wbr><span class="parameters">(double[]&nbsp;a)</span></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>a</code> - </dd>
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="createFineHistogram(double[],double)">
<h3>createFineHistogram</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double[][]</span>&nbsp;<span class="element-name">createFineHistogram</span><wbr><span class="parameters">(double[]&nbsp;x,
 double&nbsp;h)</span></div>
<div class="block">calculate a fine resolution histogram for x, for a larger data range than x's.
 (NOTE that if the data are circular, a method can be created to calculate the histogram
 using the same data range as x, not larger)</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>x</code> - </dd>
<dd><code>h</code> - </dd>
<dt>Returns:</dt>
<dd>a 2-dimensional array of the histogram where hist[0] holds the centers of the histogram bins,
 and hist[1] holds the counts within the bins.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="createFineHistogram(double[],double,int,double,double,double)">
<h3>createFineHistogram</h3>
<div class="member-signature"><span class="modifiers">protected static</span>&nbsp;<span class="return-type">double[][]</span>&nbsp;<span class="element-name">createFineHistogram</span><wbr><span class="parameters">(double[]&nbsp;x,
 double&nbsp;h,
 int&nbsp;nBins,
 double&nbsp;binWidth,
 double&nbsp;minBin,
 double&nbsp;maxBin)</span></div>
<div class="block">calculate a fine resolution histogram for x, for a larger data range than x's.
 (NOTE that if the data are circular, a method can be created to calculate the histogram
 using the same data range as x, not larger)</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>x</code> - </dd>
<dd><code>h</code> - </dd>
<dd><code>nBins</code> - </dd>
<dd><code>minBin</code> - </dd>
<dd><code>binWidth</code> - </dd>
<dd><code>maxBin</code> - </dd>
<dt>Returns:</dt>
<dd>a 2-dimensional array of the histogram where hist[0] holds the centers of the histogram bins,
 and hist[1] holds the counts within the bins.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="createFineHistogramSubstitute(double[])">
<h3>createFineHistogramSubstitute</h3>
<div class="member-signature"><span class="modifiers">protected static</span>&nbsp;<span class="return-type">double[]</span>&nbsp;<span class="element-name">createFineHistogramSubstitute</span><wbr><span class="parameters">(double[]&nbsp;x)</span></div>
<div class="block">calculate a substitute for the fine resolution histogram for x for use in the
 risk estimator that uses cross-validation.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>x</code> - </dd>
<dt>Returns:</dt>
<dd>a 2-dimensional array of the histogram where hist[0] holds the centers of the histogram bins,
 and hist[1] holds the counts within the bins.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="viaFFTGaussKernel(algorithms.misc.Complex[],double[],double)">
<h3>viaFFTGaussKernel</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="KernelDensityEstimator.KDE.html" title="class in algorithms.misc">KernelDensityEstimator.KDE</a></span>&nbsp;<span class="element-name">viaFFTGaussKernel</span><wbr><span class="parameters">(<a href="Complex.html" title="class in algorithms.misc">Complex</a>[]&nbsp;u,
 double[]&nbsp;histBins,
 double&nbsp;h)</span></div>
<div class="block">estimate the density by using properties of exponentials 
     (convolution, discrete FFT, fourier pairs ...) to make a faster algorithm.
     <pre>
           reference:
           Silverman, B. W. (1982). Algorithm as 176: Kernel density estimation using the fast Fourier transform. Journal of the Royal Statistical Society. Series C (Applied Statistics), 31(1), 93-99. https://dx.doi.org/10.2307/2347084.
           https://www.jstor.org/stable/2347084#metadata_info_tab_contents
     </pre>
     calculate the KDE in a fast manner by using discrete FFTs and using a grid of data points
     the kde = f_hat(x) ~ summation over i=1 to n of (K(|| x - X_i ||/h).
     the kernel estimate is a convolution of the data with the kernel.
     A naive implementation such as the method viaGaussKernel() is O(n^2).
     If the kernel K is chosen to be a Gaussian, one can use a property of exponentials to rewrite:
     exp(x - X_i) = exp(x) * exp(-X_i) (neglecting details)
     also note that the discrete FFT is a summation of exponentials.
     convolution theorem: one can use the pointwise multiplication between the fourier paired functions.
     (Chap 15.5, Boas "Mathematical Methods in the Physical Sciences")
     convolution to FFT:
     FFT(kde) ~ FFT(K(h*s)) * FFT( hist(X) )
     one can choose s to be the same spatial intervals (=grid) in the histogram
     and in the kernel, to avoid interpolation.  the multiplication is pointwise.
     then inverse FFT of FFT(kde) = kde.
     the runtime complexity is then O(n_s*log(n_s))
 The Gaussian Kernel with discrete fast fourier transforms is O(s*log(s)).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>u</code> - the FFT of the histogram of the data.</dd>
<dd><code>histBins</code> - the x bins of the histogram of the data that were used to create u</dd>
<dd><code>h</code> - </dd>
<dt>Returns:</dt>
<dd>kernel density estimate</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="sumKDE(double[],double)">
<h3>sumKDE</h3>
<div class="member-signature"><span class="modifiers">static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">sumKDE</span><wbr><span class="parameters">(double[]&nbsp;kde,
 double&nbsp;dk)</span></div>
</section>
</li>
<li>
<section class="detail" id="assertHistRange(double[],double[],double)">
<h3>assertHistRange</h3>
<div class="member-signature"><span class="modifiers">protected static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">assertHistRange</span><wbr><span class="parameters">(double[]&nbsp;histBins,
 double[]&nbsp;dataMinMax,
 double&nbsp;h)</span></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>histBins</code> - </dd>
<dd><code>dataMinMax</code> - </dd>
<dd><code>h</code> - </dd>
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="univariateKernelDensityEstimate(algorithms.misc.IKernel,double,double[],double)">
<h3>univariateKernelDensityEstimate</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">univariateKernelDensityEstimate</span><wbr><span class="parameters">(<a href="IKernel.html" title="interface in algorithms.misc">IKernel</a>&nbsp;kernel,
 double&nbsp;x,
 double[]&nbsp;xTilde,
 double&nbsp;h)</span></div>
<div class="block">estimate the KDE for a single value x.
     NOTE that this method is not efficent if used to calculate many x.  one should instead use the FFT method.
     <pre>
     Wasserman chap 20:
     let X_0,...X_{N-1) denote the observed data which is a sample from f (= probability distribution).
     K is the kernel.
     the1-Dimensional  KDE estimator f_hat(x) = (1/n) * sum_i=0_to_{N-1} ( (1/h) * K((x - X_i)/h).
     runtime complexity is O(xTilde.length).
     </pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>kernel</code> - </dd>
<dd><code>x</code> - </dd>
<dd><code>xTilde</code> - the observed data</dd>
<dd><code>h</code> - the kernel bandwidth</dd>
<dt>Returns:</dt>
<dd>the kde at x</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="crossValidationScore(algorithms.misc.Complex[],double[],double)">
<h3>crossValidationScore</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">crossValidationScore</span><wbr><span class="parameters">(<a href="Complex.html" title="class in algorithms.misc">Complex</a>[]&nbsp;u,
 double[]&nbsp;histBins,
 double&nbsp;h)</span></div>
<div class="block">a fast cross-validation method which can be used in choosing the bandwidth for the kernel density estimator.
 the runtime complexity is max( O(n), O(n_s*log_2(ns)))
  where n is the data length, and n_s is the number of elements in the data histogram
 (which is equal to u.length).
 This method is implemented for 1-D only, but the references (eqn 27) provide a formula for multiple dimensions.

 NOTE: this method is not ready for use.  I altered the normalization of one of the terms,
 but the change is a fudge.
 The test results using the "fudge" look good.
 This comment will be removed when corrected.
     <pre>
     References:
     Wasserman, "All of Statistics", eqn (20.25)
     and
     https://www.stat.cmu.edu/~larry/=sml/densityestimation.pdf
     36-708 Statistical Methods for Machine Learning by Larry Wasserman, CMU
     eqn (27) (which is (27)+(28))
     and
     Indirect Cross-validation for Density Estimation
     Olga Y. Savchuk, Jeffrey D. Hart, Simon J. Sheather
     https://doi.org/10.48550/arxiv.0812.0051,
     https://arxiv.org/abs/0812.0051,
     eqn (2).
     </pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>u</code> - fft of the histogram of the data.</dd>
<dd><code>histBins</code> - the x axis of the histogram of the data.</dd>
<dd><code>h</code> - the bandwidth to use</dd>
<dt>Returns:</dt>
<dd>the cross validation score</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="riskEstimatorLeaveOneOut()">
<h3>riskEstimatorLeaveOneOut</h3>
<div class="member-signature"><span class="modifiers">static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">riskEstimatorLeaveOneOut</span>()</div>
<div class="block">calculate the risk estimator for the "leave-one-out" method of cross validation.
 This method can be used to select a kde bandwidth by minimizing the risk estimator for a range
 of bandwidths.  It is a data based method as the true probability distribution is unknown.
     <pre>
     see eqn (20.24) of Wasserman's "All of Statistics"
     see eqn (26) of
     https://www.stat.cmu.edu/~larry/=sml/densityestimation.pdf
     36-708 Statistical Methods for Machine Learning by Larry Wasserman, CMU
     </pre></div>
<dl class="notes">
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="riskEstimatorDataSplitting()">
<h3>riskEstimatorDataSplitting</h3>
<div class="member-signature"><span class="modifiers">static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">riskEstimatorDataSplitting</span>()</div>
<div class="block">calculate the risk estimator for the "data-splitting" V-fold or k-fold method of cross validation.
 This method can be used to select a kde bandwidth by minimizing the risk estimator for a range
 of bandwidths.  It is a data based method as the true probability distribution is unknown.
     <pre>
     see eqn (20.24) of Wasserman's "All of Statistics".
     see eqn (26) of
     https://www.stat.cmu.edu/~larry/=sml/densityestimation.pdf
     36-708 Statistical Methods for Machine Learning by Larry Wasserman, CMU
     </pre></div>
<dl class="notes">
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="riskEstimatorGaussianKernel()">
<h3>riskEstimatorGaussianKernel</h3>
<div class="member-signature"><span class="modifiers">static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">riskEstimatorGaussianKernel</span>()</div>
<div class="block">calculate the risk estimator for the "leave-one-out" method of cross validation.
 This method can be used to select a kde bandwidth by minimizing the risk estimator for a range
 of bandwidths.  It is a data based method as the true probability distribution is unknown.
     <pre>
     see eqn (27), (28) of
     https://www.stat.cmu.edu/~larry/=sml/densityestimation.pdf
     36-708 Statistical Methods for Machine Learning by Larry Wasserman, CMU.
     see eqn (20.24) of Wasserman's "All of Statistics"
     </pre></div>
<dl class="notes">
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="sumHistogram(double[][])">
<h3>sumHistogram</h3>
<div class="member-signature"><span class="modifiers">static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">sumHistogram</span><wbr><span class="parameters">(double[][]&nbsp;hist)</span></div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
